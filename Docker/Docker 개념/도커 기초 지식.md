Docker에 대해 학습하기 전 Docker가 무엇인지에 대해 알아야 한다.  
먼저 Docker의 정의를 학습 후 Docker를 이해하기 위한 필수 개념인 컨테이너 및 가상화에 대해 공부.

# 도커의 정의

도커(Docker)라는 용어는 회사를 의미할 수 있고 SW를 의미할 수 있다.  
회사로서의  Docker는 최초 2008년 솔로몬 하익스(solomon Hykes)가 프랑스 파리에서 닷클라우드(DotCloud)라는 이름으로 설립.  
그리고 2013년 9월 19일에 PaaS(Platform-as-a-Service)의 형태로 출시.

SW로서의 Docker는 컨테이너(Container)라고 부르는 OS 수준의 가상화 방식 SW를 배포하는 방식을 사용하는 PaaS 제품을 의미.  
PaaS는 Platform as a Service의 줄임말로 애플리케이션, 데이터 단계만 사용자가 관리하는 서비스 의미.  
Docker를 사용 다양한 개발 환경에서 컨테이너를 이용 SW를 편리하게 배포할 수 있다. Dcoker는 오픈소스이므로 누구나 사용할 수 있는 SW.

---

### On premises

- 사용자 관리
    - 애플리케이션
    - Data
    - 런타임
    - 미들웨어
    - OS
    - 가상화
    - 서버
    - 스토리지
    - 네트워킹

### IaaS

- 사용자 관리
    - 애플리케이션
    - Data
    - 런타임
    - 미들웨어
    - OS
- 업체 관리
    - 가상화
    - 서버
    - 스토리지
    - 네트워킹

### PaaS

- 사용자 관리
    - 애플리케이션
    - Data
- 업체 관리
    - 런타임
    - 미들웨어
    - OS
    - 가상화
    - 서버
    - 스토리지
    - 네트워킹

### SaaS

- 업체 관리
    - 애플리케이션
    - Data
    - 런타임
    - 미들웨어
    - OS
    - 가상화
    - 서버
    - 스토리지
    - 네트워킹

---

개발한 SW를 배포할 때,  
다양한 환경에서 발생하는 문제는 많은 스트레스를 준다. A라는 환경에서는 문제없이 배포되지만, B라는 환경에서는 시스템 설정이나 의존성 차이로 인해 배포할 수 없는 경우 쉽게 찾아 볼 수 있다.

### 서버 1

- SW A
- SW B X
- SW C v5.0

### 서버 2

- SW A O
- SW B
- SW C v6.0

SW A와 SW B를 서버 1과 서버2에 설치하는 상황을 가정.  
서버 1에는 SW C v5.0이 설치되어 있고 서버 2에는 SW C v6.0이 설치.  
SW A는 SW C v5.0에서 작동, SW B는 SW C v6.0에서 작동. SW A는 서버 1에서는 작동하지만 서버 2에서는 작동하지 않는다. Docker를 사용하면 SW C를 버전에 따라 각각 다르게 격리시키며 하나의 서버에 SW A와 B 모두 설치할 수 있다.

OS 위 Docker가 설치되고 Docker는 컨테이너 단위로 애플리케이션을 실행한다. 커네티언들은 서로 격리되어 있으므로 독립성을 보장한다. 각 컨테이너는 애플리케이션을 실행하는 데 필요한 최소한의 바이너리, 라이브러리를 포함한다.

# 컨테이너의 개념

SW 개발 환경에서의 컨테이너(Container)란?  
컨테이너느 SW를 배포할 때 필요한 코드, 라이브러리, 환경 설정 파일들을 한데 모아 격리시킨 후 실행가능한 패키지로 만든 것을 의미.  
서로 다른 컨테이너는 격리된 환경에서 작동되므로 서로 충돌하지 않는다는 장점이 있다.  
이러한 컨테이너 개념은 SW 시스템을 구축할 때 최소 구성 요소로 분활하여 구축하는 방식인 마이크로서비스 아키텍처(Microservice Architectgure)의 기반이 된다.

# 가상화의 개념

Dcoekr를 이해하려면 가상화의 개념을 먼저 이해해야 한다.  
가상화(Virtualization)란 컴퓨터에서 활용하는 리소스를 추상화하는 개념을 의미하는 용어. 가상화 개념을 활용해 여러 개의 가상머신을 생성함으로써, 단일 컴퓨팅 자원을 여러 개의 논리적인 지원을 나누어 동작시킬 수 있다.

### 가상화의 종류

**호스트 가상화**

- HW
- 호스트 OS
- 하이퍼바이저
- VM1
    - 애플리케이션1
    - 바이너리/라이브러리
    - 게스트 OS
- VM2
    - 애플리케이션1
    - 바이너리/라이브러리
    - 게스트 OS
- VM3
    - 애플리케이션1
    - 바이너리/라이브러리
    - 게스트 OS

**하이퍼바이저**

- HW
- 하이퍼바이저
- VM1
    - 애플리케이션1
    - 바이너리/라이브러리
    - 게스트 OS
- VM2
    - 애플리케이션1
    - 바이너리/라이브러리
    - 게스트 OS
- VM3
    - 애플리케이션1
    - 바이너리/라이브러리
    - 게스트 OS

**컨테이너 가상화**

- HW
- OS
- Docker
- 컨테이너1
    - 애플리케이션1
    - 바이너리/라이브러리
- 컨테이너2
    - 애플리케이션1
    - 바이너리/라이브러리
- 컨테이너3
    - 애플리케이션1
    - 바이너리/라이브러리

첫번재, 호스트 가상화.  
OS를 설치한 후 하이퍼바이저를 통해 가상머신을 만들고 각 가상머신 내부에는 게스트 OS가 설치. 이때 하이버파이저(Hypervisor)란 단일 물리 머신에서 다수의 가상머신을 실행할 때 활용하는 SW를 의미. 비추얼박스, VM웨어(vmware)등과 같은 종류.  
일반적으로 호스트 가상화 방식을 많이 사용.

두번째, 하이퍼바이저 가상화.  
호스트 가상화와는 달리 호스트 OS를 필요로 하지 않는 방식이다. 호스트 OS가 존재하지 않으므로 부팅 시 가상머신을 선택하게 된다. 성능이 우수하다는 장점이 있다  
하지만, 초기 설정이 복잡하고 관리가 어려울 수 있다는 단점이 있다.

세번째, 컨테이너 가상화.  
OS 위 컨테이너를 운영하기 위해 필요한 Docker 설치한 후 다수 컨테이너를 통해 애플리케이션을 실행하는 방식. Docekr, 쿠버네티스는 커네티언 가상화 방식을 활용하는 SW. 컨테이너 가상화 방식을 사용하면 컨테이너 간 격리가 도기 때문에 다른 애플리케이션에 영향을 미치지 않아 서로 다른 컴퓨팅 환경에서 애플리케이션을 실행하는 데 용이하다.

# 도커 구성 요소

Docker 구성 요소 단순화

docker-cli → dockerd → containerd → containerd-shim → runc → 컨테이너

docker-cli → dockerd → containerd → containerd-shim → runc → 컨테이너

docker-cli → dockerd → containerd → containerd-shim → runc → 컨테이너

---

Docker 클라이언트(Dcoker Client)는 docker-cli라고 부른다. Docker Client는 우분에서 실행하는 터미널이라고 생각하면 도니다. Docker Client는 명령어 행으로 dockerd API를 활용해 **build, pull, run**과 같은 명령을 내린다. 또한 Dcoker Client는 Dcoker 데몬(Dcoker Daemon)과 통신.

Dcoker Daemon은 Dcokerd라고 부르는데 백그라운드에서 실행되는 Daemon 프로세스에 해당.  
Dcoker Daemon API 요청을 수신하고 Docker image, 컨테이너 등과 같ㅌ은 Docker와 관련 객체를 관리.

containerd는 컨테이너 실행과 관리에 필요한 기능을 수행하는 오픈소스 컨테이너 런타임. containerd는 컨테이너의 생명주기를 모두 관리. 생명주기는 docker image 전송, 컨테이너 전송, 실행, 스토리지, 네트워킁 등을 포함한다. 컨테이너 실행만 담당하는 runc와는 다른 역할을 하며 고수준 컨테이너 런타임Light-Level Container runmitme)에 해당.

runc는 컨테이너 실행과 관련된 작업을 수행하는 저수준 컨테이너 런타임(Low-Level Container runtime). containerd는 실행 이외에도 컨테이너 관리를 위해 다양한 역할을 하지만, runc는  실제 컨테이ㅏ너 실행만 담당.

containerd-shim은 containerd와 runc 사이에서 작동하는 중간 프로세스에 해당하는데, 컨테이너 실행을 조정하는 역할을 한ㄷ나. containerd는 runc와 토임함으로써 컨테이너를 실행.  
이때, containerd-shim containerd와 runc 사이 중개자 역할을 수행.