# Docker 개념

## 운영체제의 개념

컴퓨터란?   
컴퓨터는 크게 ‘**하드에어(HW, Hardware)**’, ‘**소프트웨어(SW, Software)**’ 구성.   
HW는 손으로 만질 수 있는 기계 장치를 의미.

### HW 측면 캠퓨터 개념

컴퓨터는 좁은 의미로 CPU와 RAM의 모음.  
컴퓨터 본체 열었을 때 나오는 CPU와 RAM만 있어도 좁은 의미의 컴퓨터.  
키보드, 마우스와 같은 입력 장치, 모니터와 같은 출력 장치, SSD와 같은 보조 기억 장치들은 부가적인 장치라 생각.

### SW 측면 컴퓨터 개념

프로그램들이 SW에 해당 (e.g. 엑셀, 파워포인트)  
SW에는 운영체제라 부르는 특별한 SW 존재, **운영체제(OS, Operating System)** SW를 의미.  
OS가 있어야 프로그램들을 실행할 수 있음 → HW, SW 자원을 관리하고 스케줄링 기능을 제공할 뿐 아니라 프로그램 실행될 수 있는 환경을 제공하는 역할

컴퓨터는 HW, SW로 구성.  
SW는 OS와 애플리케이션(Application) 나뉘게 되고  
OS는 커널과 그 외 라이브러리로 나뉘어짐

OS와 애플리케이션에서는 셸이 존재. **셸(shell)**은 껍질이란 뜻, OS를 껍질처럼 감싸고 있음.

셸은 OS와 사용자 사이 다리 역할을 하는 프로그램.  
셸을 통해 사용자 명령어 입력함으로써 OS와 상호작용하며 다양한 작업 수행. 다양한 환경 및 사용자 요구 만족하기 위해 bash, zsh 등 다양한 종류 셸 개발.

## 프로그램, 프로세스, 스레드의 개념

**프로그램(Program)**은 실행 가능한 **명령어(Instruction)**의 집합을 의미.  
프로그램 하드 디스크와 같은 저장 장치에 저장, 메모리에는 올라가지 않은 정적인 상태를 의미.

e.g. chrome.exe라는 프로그램, 프로그램은 디스크에 존재하는 명령어 집합을 의미.

**프로세스(Process)** 실행 중인 프로그램 의미하며 동적인 상태 프로그램 의미.  
프로그램과 프로세스의 차이.

프로그램은 디스크에 존재하는 명령어 집합, 프로세스는 실행 중인 프로그램을 의미 RAM에 존재하는 것을 알 수 있음

프로그램과 프로세스의 차이 좀 더 수비게 나타냄.  
파워포인트라는 프로그램을 사용한다고 했을 때, 디스크에 설치되어 있는 파워포인트는 프로그램에 해당, 파워포인트를 더클 클릭해 실행 후 새 문서 파일은 프로세스에 해당.

멀티 프로세스는 디스크에 존재하는 프로그램을 여러 번 실행해서 여러 개의 프로세스 작동시키는 것을 의미.

멀티 프로세스  
e.g. 파워포인트 세 번 실행

**스레드(Thread)** 프로세스 할당받은 자원 이용하는 실행 단위 프로세스 내에 실행되는 여러 흐름의 단위를 의미.  
프로세스는 최소 한 개 잉상 스레드를 가지며 메인 스레드(main Thread)라 함.  
프로세스는 스레드의 컨테이너에 해당.  
프로세스는 스레드의 정보를 담고 있는 것.

스레드 개념.  
워드 프로그램의 경우, 하나의 스레드 화면상에 글자를 보여주는 일을 하고 다른 스레드 사용자의 키 입력을 대응하고 또 다른 스레드는 백그라운드 오탈자 문법 확인하는 일.  
하나의 프로세스에 세 개의 스레드가 실행.

## 네임스페이스의 개념

**네임스페이스(Namespace)** 프로세스 실행할 때 시스템 리소스 분리해서 실행할 수 있도록 도와주는 기능.  
우리나라 주민등록번호 활용 서로 구분. → 컴퓨터 시스템엫서도 서로 다른 리소스 구분 위한 식별 방법 필요, 이 때 사용하는 기능이 Namespace.

### 리눅스 네임스페이스

| 네임스페이스 | 의미 | 역할 |
| --- | --- | --- |
| pid | PID:Process ID | 리눅스 커널 프로세스 ID 분리 |
| net | NET:NEtworking | 네트워크 인터페이스(NET) 관리 |
| ipc | IPC:Inter Process Communication | 프로세스 간 통신(IPC) 접근 관리 |
| mnt | MNT:Mount | 파일 시스템의 마운트 관리 |
| uts | UTS:Unix timesharing System | 커널과 버전 식별자 관리 |

주요 네임스페이스의 종류와 역할에 대해 정리한 표.  
각각 기능 활용하면 프로세스 격리시켜 충돌 방지, 그 외 (네임스페이스도 공부하자!)

# 도커 기초 지식

## 도커의 정의

**도커(docker)** 용어는 회사를 의미, 또는 SW 의미.  

### 회사…

회사로서의 docker는 2008년 솔로몬 하익스(Solomon Hykes)가 프랑스 파리 닷클라우드(dotCloud)라는 이름으로 설립. 2013년 9월 19일PaaS(Platform-as-a-Service) 형태로 출시

### SW…

SW로서의 docker는 **컨테이너(Container)**라는 OS 수준의 가상화 방식 SW 배포 방식 사용하는 PaaS 제품을 의미. **PaaS는 Platform as a Service**의 줄임말. 애플리케이션, data 단계만 사용자 관리하는 서비스 의미. Docker 사용하면 다양한 개발 환경 Container 이용해 SW 편리하게 배포. Docker는 오픈소스이므로 누구나 사용할 수 있는 SW.

A라는 환경에서 배포하는 데 문제가 없지만, B라는 환경에서는 시스템 환경이 달라 배포할 수 없는 경우 쉽게 찾아 볼 수 있음 → Docker 활용

SW A와 SW B를 서버 1과 서버 2에 설치하는 상황 가정.  
서버 1에는 SW C버전 5.0설치, 서버 2에는 SW C버전 6.0 설치.  
SW A는 SW C버전 5.0에 작동, SW B는 SW C버전 6.0 작동, SW A는 서버 1에서 작동하지만 서버 2에서는 작동하지 않음. 반면 SW B는 서버 1에서는 작동하지 않지만 서버 2에서는 작동.  
Docker를 사용해 SW C 버전 따라 각각 다르게 격리시키면 하나의 서버에 SW A와 B 모두 설치 가능

OS 위에 Docker가 설치, Docker는 Container 단위로 애플리케이션 실행 Container 서로 격리 독립성 보장. 각 컨테이너 애플리케이션 실행하는 데 필요한 최소한 바이너리, 라이브러리 포함.

## 컨테이너 개념

SW 개발에서의 컨테이너(Container)?  
Container는 SW배포할 때 필요한 코드, 라이브러리, 환경 설정 파일들을 한데 모아 격리시킨 후 실행가능한 패키지로 만든 것을 의미.  
서로 다른 Container는 격리된 환경에서 작동되므로 서로 충돌하지 않는다는 장점. → Container의 개념은 SW 시스템 구축할 때 최소 구성 요소 분할하여 구축하는 방식인 마이크로서비스 아키텍처(Microservice Architectgure) 기반.

격리된 서로 다른 Container끼리 통신 주고받을 수 있음.  
→ Container가 동일한 OS 위에서 작동하기 때문에 가능. 작동 원리는 가상머신에 비해 리소스 소모량이 적으므로 더 효율적인 리소스 관리 가능

## 가상화의 개념

**가상화(Virtualization)**?  
컴퓨터 활용하는 리소스 추상화 개념 의미하는 용어.  
가상화 개념 활용해 여러 개의 가상머신을 생성함으로써, 단일 컴퓨팅 자원 여러 개의 논리적인 자원으로 나누어 동작.

호스트 가상화라 부름.  
운영체제 설치한 후 하이퍼바이저르 통해 가상머신 만들고 각 가상머신 내부에는 게스트 OS가 설치.  
**하이퍼바이저(Hypervisor)**란  
단일 물리 머신에서 다수 가상머신 실행할 때 활용하는 SW 의미. 부추얼박스, VM웨어 등과 같은 종류.  
일반적으로 호스트 가상화 방식을 많이 사용

하이퍼바이저 가상화는 호스트 가상화와는 달리 호스트 운영체제 필요로 하지 않는 장식에 해당.  
호스트 OS 존재하지 않으므로 부팅 시 가상머신 선택. 성능 우수한다는 장점 있음, 초기 설정 복잡하고 관리가 어려울 수 있다는 단점.

OS 위 Container를 운영하기 위해 필요한 Docker 설치 후 다수 Container 가상화 방식 활용 SW.  
Container 가상화 방식 사용 Container 간 격리 다른 애플리케이션 영향을 미칮 않아 서로 다른 컴퓨팅 환경 애플리케이션 실행하는 데 용이.

## 도커 구성 요소

**도커 클라이언트(Docker Clinet)**는 docker-cli라고 부름.  
Docker Clinet 우분터에서 실행하는 터미널이라고 생각. Docker Client 명령어 행으로 docker API 활용해 **build, pull run**과 같은 명령어 내림. **Docker Clinet 도커 데몬(Docker daemon)과 통신.**

Docker Daemon은 docker 부르는데 백그라운드 실해오디는 데몬 프로세스에 해당.  
Docker Daemon은 API 요청 수신 Docker image, Container 등과 같은 Docekr와 관련된 객체를 관리.

containerd는 Container 실행과 관리에 필요한 기능 수행 오픈소스 Container 런타임.  
containerd는 Container의 생명주기 모두 고나리. 생명주기는 Docker image 전송, Container 실행, 스토리지, Network 등을 포함. Container 실행만 담당하는 runc와는 다른 역할을 하며 **고수준 컨테이너 런타임(High-Level Container runtime)**에 해당

runc는 Container 실행과 고날녀 작업을 수행하는 **저수준 컨테이너 런타임(Low-Level Container runtime)**. containerd는 실행 외 Container 관리 위한 다양한 역할, runc 실제 Container 실행만 담당.

containerd-shim은 containerd와 runc 사이 작동하는 중간 프로세스 해당, Container 실행 조정하는 역할. containerd는 runc와 통신함으로써 Container를 실행. containerd-shim이 containerd와 runc 사이 중재자 역할 수행.